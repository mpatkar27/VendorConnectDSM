sap.ui.define(["sap/base/assert","gramont/VCDSM/specedit/util/Util"],function(e,t){"use strict";var i=function(e){this._oComponent=e;this._oSpecificationKey=null;this._aBeforeSaveCbs=[];this._aAfterSaveCbs=[];this._aAfterResetCbs=[]};i.prototype.setSpecificationKey=function(e){this._oSpecificationKey=e};i.prototype.attachBeforeSave=function(e){this._aBeforeSaveCbs.push(e)};i.prototype.attachAfterSave=function(e){this._aAfterSaveCbs.push(e)};i.prototype.attachAfterReset=function(e){this._aAfterResetCbs.push(e)};i.prototype.needSave=function(){e(this._oSpecificationKey,"oSpecificationKey should be set");var t=this._oComponent.getModelManager().needSaveForSpecificationByKey(this._oSpecificationKey);return t};i.prototype.save=function(){this._save(true,null)};i.prototype.reset=function(){this._reset(true,null)};i.prototype.confirmAndSave=function(e,i,o){var n=function(e){if(o)o(e)};if(this.needSave()){t.showMessageBox(this._oComponent,{type:t.MessageBoxType.Confirm,message:e,cancel:i},jQuery.proxy(this._onConfirmAndSaveConfirm,this,n))}else{var s=function(e){n(true)};this._save(false,s)}};i.prototype.confirmAndReset=function(e,i,o){var n=function(e){if(i)i(e)};this._key=o;if(this.needSave()){t.showMessageBox(this._oComponent,{type:t.MessageBoxType.Confirm,message:e},jQuery.proxy(this._onConfirmAndResetConfirm,this,n))}else{var s=function(){n(true)};this._reset(false,s)}};i.prototype._save=function(t,i){e(this._oSpecificationKey,"oSpecificationKey should be set");this._runCbs(this._aBeforeSaveCbs,[]);var o=this._aAfterSaveCbs.slice(0);if(i)o.push(i);var n=jQuery.proxy(this._afterSave,this,o);if(t){this._oComponent.getModelManager().saveSpecificationByKey(this._oSpecificationKey,n)}else{var s=this._oComponent.getModelManager().createSaveInfo(true,[]);n(s)}};i.prototype._afterSave=function(e,t){this._runCbs(e,[t])};i.prototype._reset=function(t,i){e(this._oSpecificationKey,"oSpecificationKey should be set");if(this._key=="maintain"||this._bOK==true){if(t)this._oComponent.getModelManager().resetSpecificationByKey(this._oSpecificationKey)}var o=this._aAfterResetCbs.slice(0);if(i)o.push(i);this._runCbs(o,[])};i.prototype._runCbs=function(e,t){var e=e.slice(0);var i=0;var o=function(){if(i<e.length){var n=e[i++];var s=t.slice(0);s.push(o);n.apply(null,s)}};o()};i.prototype._onConfirmAndSaveConfirm=function(t,i){switch(i){case true:this._save(true,jQuery.proxy(this._onConfirmAndSaveSaveDone,this,t));break;case false:t(false);break;case null:t(null);break;default:e(false,"bOK is unknown")}};i.prototype._onConfirmAndSaveSaveDone=function(e,t){e(t.success?true:null)};i.prototype._onConfirmAndResetConfirm=function(e,t){this._bOK=t;if(this._key=="prereq"){this._reset(true,jQuery.proxy(this._onConfirmAndResetResetDone,this,e))}else{if(t)this._reset(true,jQuery.proxy(this._onConfirmAndResetResetDone,this,e));else e(false)}};i.prototype._onConfirmAndResetResetDone=function(e){e(true)};return i});