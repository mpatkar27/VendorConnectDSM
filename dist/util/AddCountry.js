sap.ui.define(["gramont/VCDSM/specedit/util/SpecDataTabBase","sap/m/library","sap/m/Link","gramont/VCDSM/specedit/util/ModelManagerAdmin","gramont/VCDSM/specedit/util/ModelManagerAutoGrowOp","gramont/VCDSM/specedit/util/ModelManagerIntStatus","sap/ui/model/json/JSONModel","gramont/VCDSM/specedit/util/PropMultiComposition","sap/base/assert","gramont/VCDSM/specedit/util/ValueHelperDialog"],function(t,e,o,a,s,r,i,n,h,d){"use strict";var p=function(e,o,a,s,r){t.call(this,e,"gramont.VCDSM.specedit.frag.AddCountry");this._oComponent=e;this._vhiIndex=null;this._rowmod=null;this._usagecollection=null;this._treenode=o;this.selectedkeys=null;this._panel1=this._byId("pnl1");this._spec=this._byId("specinp");this._specdet=this._byId("specdetinp");this._adcntrytab=this._byId("countryusagetab");this.patharr=[];this._oDialogadd=e.getNavigator().createFragment("gramont.VCDSM.specedit.frag.AddCountry",this);this._udtmod=a;this._oldudt=s;this._cmbmod=r;this._Odiagrestab=new i;this._oDialogadd.control.setModel(this._Odiagrestab);this._oDialogadd.control.open();var n=this._oComponent.getODataManager().requestForFetchCountry();this._oComponent.getODataManager().executeRequest(n,jQuery.proxy(this._FetchCountrySuccess,this))};p.prototype=Object.create(t.prototype);p.prototype.constructor=p;p.prototype._onCloseusag=function(){this._oDialogadd.control.close()};p.prototype._onchange=function(t){var e=t.getSource().getBindingContext().getPath().split("/");var o=parseInt(e[1]);var a=t.getSource().getModel();this._modtab=a;var s="/"+o+"/Change";var r=a.setProperty(s,true)};p.prototype._onSelectionChng=function(t){var e=t.getSource().getBindingContext().sPath;if(this.patharr.length==0){this.patharr.push(e)}else{for(var o=0;o<this.patharr.length;o++){if(this.patharr[o]==e){this.patharr.splice(o,1);o--}else{this.patharr.push(e)}}}};p.prototype._onok=function(t){var e=[{ACTN:"",MENID:"",ID:"",RECNROOT:"",ESTCAT:""}];e[0].ACTN=this._treenode.ACTN;e[0].RECNROOT=this._treenode.RECNROOT;e[0].ESTCAT=this._treenode.ESTCAT;for(var o=0;o<this.patharr.length;o++){var a=this._Odiagrestab.getProperty(this.patharr[o]);a.ESTCAT=this._treenode.ESTCAT;a.RECNROOT=this._treenode.RECNROOT;a.RECNMST="";a.RECNPARENT="";a.ACTN=this._treenode.ACTN;var s=this._oComponent.getODataManager().requestForUpdateUsagedat(a);this._oComponent.getODataManager().executeRequest(s,jQuery.proxy(this._onUpdtSuccess,this))}};p.prototype._onUpdtSuccess=function(t){var e=this._udtmod.getData();if(e.length!=0){var o=jQuery.extend(true,{},e[e.length-1]);o.ACTN=this._treenode.ACTN;o.ORD=t.ORD;o.RECNPARENT=t.RECNPARENT;o.RECNROOT=t.RECNROOT;o.ACTN_VP=t.ACTN_VP;o.RECN_VP=t.RECN_VP;o._ModelManagerADMIN.intStatus=r.Modified;o.DELFLAG="";var a=this._oldudt.getData();a.push(o);var s=this._cmbmod.getData();s.push(o);this._cmbmod.refresh();e.push(o);this._udtmod.refresh()}else{e=this._oldudt.getData();var o=jQuery.extend(true,{},e[0]);o.ACTN=this._treenode.ACTN;o.RECNPARENT=t.RECNPARENT;o.RECNROOT=t.RECNROOT;o.ACTN_VP=t.ACTN_VP;o.RECN_VP=t.RECN_VP;o._ModelManagerADMIN.intStatus=r.Modified;o.DELFLAG="";var a=this._oldudt.getData();if(a[0].RECN=="0"){a.splice(0,1);a.push(o)}var e=this._udtmod.getData();e.push(o);this._udtmod.refresh()}this._oDialogadd.control.close()};p.prototype._FetchCountrySuccess=function(t){this._usagecollection=t.entries;for(var e=0;e<t.entries.length;e++){t.entries[e].Selected=false}this._Odiagrestab.setProperty("/",t.entries);this._modtab=this._Odiagrestab};return p});