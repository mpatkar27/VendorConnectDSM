sap.ui.define(["sap/ui/model/json/JSONModel","sap/base/assert","gramont/VCDSM/specedit/control/Column","gramont/VCDSM/specedit/control/ColumnListItem","gramont/VCDSM/specedit/util/TableManager","gramont/VCDSM/specedit/util/PropBase","gramont/VCDSM/specedit/util/ModelManagerAdmin","gramont/VCDSM/specedit/util/ModelManagerAutoGrowOp","gramont/VCDSM/specedit/util/ModelManagerIntStatus","sap/ui/richtexteditor/RichTextEditor"],function(e,t,a,o,r,n,l,s,i,d){"use strict";var u=function(a,o,r,s,d,u,p,g,c){n.call(this,a,"gramont.VCDSM.specedit.frag.PropQual");this._bEditable=s;this._subsec=this._byId("qualsubsec");p[c].propid=this._subsec;this._subsec.setVisible(g.Visible);this._estcat=o.ESTCAT;this._oComponent=a;var m=new e;var v=this.getControl();v.setModel(m,"propModel");m.setProperty("/title",o.TEXT);var h=r.getAdditional().parent.CompHeader;var C=r.getAdditional();var M=this._byId("comphead");for(var b=0;b<h.length;b++){var _=h[b];var f=_.ColDescr;var I=null;if(f!=a.getI18nBundle().getText("PropInstance.sortOrder")){I=new sap.m.Label({});I.setText(f);t(I,a.getI18nBundle().getText("errorhead"));var w=new sap.m.Column({header:I});M.addColumn(w)}}var y=new sap.m.ColumnListItem;var T=function(e){var a=e.getSource().getBindingContext().getPath().split("/");t(a.length==2&&a[0]=="","Control should have absolute binding context path");var o=parseInt(a[1]);var r=e.getSource().getModel();var n=r.getData().length;var s="/"+o+"/"+l.FullPropName.IntStatus;var d=r.getProperty(s);var u=null;switch(d){case i.Empty:u=i.New;break;case i.Unchanged:u=i.Modified;break}if(u!=null)r.setProperty(s,u)};for(b=0;b<h.length;b++){_=h[b];var D=_.AsRadiobutton;if(D==true&&b!=5){var S="{"+h[0].ColId+"}";y.addCell(new sap.m.RadioButton({selected:"{"+_.ColId+"}",groupName:S,select:T,editable:s}))}else{var E=_.IsEditable;if(E==true){y.addCell(new sap.m.Input({value:"{"+_.ColId+"}",change:T}))}else{y.addCell(new sap.m.Text({text:"{"+_.ColId+"}"}))}}}var x=r.getModel().getData();var N=null;var O="_ModelManager:CREATE";var V="_ModelManagerADMIN:";for(var b=0;b<x.length;b++){N=x[b];delete N[O];N._ModelManagerADMIN.IntStatus=i.Unchanged;var A=N._ModelManagerADMIN.origEntry;delete A[O]}var B=new sap.ui.model.json.JSONModel(x);M.setModel(B);M.bindItems("/",y,null,null);var P=this._byId("udt");var L=this._byId("udt");var R=new sap.m.ColumnListItem;if(d!=null){for(var j=0;j<2;j++){if(j==0){I=new sap.m.Label({});I.setText(a.getI18nBundle().getText("Name"));w=new sap.m.Column({header:I,width:"20%"})}else if(j==1){I=new sap.m.Label({});I.setText(a.getI18nBundle().getText("val"));w=new sap.m.Column({header:I})}L.addColumn(w)}R.addCell(new sap.m.Label({text:"{TEXTNAM}"}));R.addCell(new sap.ui.richtexteditor.RichTextEditor({value:"{TEXT}",change:T,editable:s,width:"100%"}));L.bindItems("/",R,null,null);var F=d.collection.getModel().getData();var G=new sap.ui.model.json.JSONModel(F);P.setModel(G)}else{P.setVisible(false)}};u.prototype._onCharEdit=function(e,t,a){var o=e.getEntryIndexOfControl(a.getSource());var r=e.getEntry(o);t.openEdit(r,jQuery.proxy(this._onCharEditStore,this,t,o,e))};u.prototype._onCharEditStore=function(e,t,a,o,r){a.setFieldValue(t,e.getFieldName(),o,r)};u.prototype=Object.create(n.prototype);u.prototype.constructor=u;u.prototype._formatEditMode=function(e){var t=e&&this._bEditable;return t};u.prototype._infopop=function(t){this._oevent=t;var a="/sap/opu/odata/GMT/VC_ODATA_SRV";var o=new sap.ui.model.odata.ODataModel(a,true);var r=this;var n={method:"GET",urlParameters:{ESTCAT:r._estcat},context:null,success:function(t,a){r._oDialogadd=r._oComponent.getNavigator().createFragment("gramont.vc.specedit.frag.helpopup",r);r._Odiahelp=new e;r._Odiahelp.setProperty("/aData",t.Info);r._oDialogadd.control.setModel(r._Odiahelp,"resModel");r._oDialogadd.control.openBy(r._oevent.getSource());r.getOwnerComponent().getNavigator().releaseBusyDialog()},error:function(e){sap.m.MessageToast.show(e.message);r.getOwnerComponent().getNavigator().releaseBusyDialog()},async:true};o.callFunction("/GetVatInfo",n);this.getOwnerComponent().getNavigator().requireBusyDialog()};return u});