sap.ui.define(["sap/base/assert","sap/m/library","sap/ui/model/json/JSONModel","gramont/VCDSM/specedit/util/ValueHelperDialog"],function(e,o,t,r){"use strict";var i=function(e,o){e.initClassExtension(this,"gramont.VCDSM.specedit.util.AdhocReport",arguments);this._oComponent=e;this._oDialog=this._oComponent.getNavigator().createFragment("gramont.VCDSM.specedit.frag.AdhocReport",this,o);var r=this._oDialog.byId("form");this._oDialogFormModel=new t;r.setModel(this._oDialogFormModel);this._oValueHelperPropMaps={LDEPID:{LDEPID:{property:"LDEPID"}},LANGU:{LANGU:{property:"SPRAS"}}}};i.prototype.open=function(e){var o=this._oComponent.getConfig().language;var t={RECNROOT:e.RECNROOT,ACTN:e.ACTN,LDEPID:"",STATUS_CHK_IND:false,LANGU:o,KEY_DATE:this._getKeyDate()};if(this._extHookOpen)this._extHookOpen(t);else this._open(t)};i.prototype._open=function(o){this._oDialogFormModel.setData(o);e(!this._oDialog.control.isOpen(),"oDialog should be closed");this._oDialog.control.open()};i.prototype._close=function(){this._oDialog.control.close()};i.prototype._fetchReportURL=function(){var e=this._oDialogFormModel.getData();var o=this._oComponent.getODataManager().requestForFetchAdhocReportURL(e);this._oComponent.getODataManager().executeRequest(o,jQuery.proxy(this._fetchReportURLSuccess,this))};i.prototype._fetchReportURLSuccess=function(e){this._close();o.URLHelper.redirect(e,true)};i.prototype._getKeyDate=function(){var e=new Date;e.setHours(0);e.setMinutes(0);e.setSeconds(0);return e};i.prototype._resetKeyDate=function(){this._oDialogFormModel.setProperty("/KEY_DATE",this._getKeyDate())};i.prototype._onValueHelpRequest=function(e){r.openDialog(this._oComponent,"AdhocReport",this._oValueHelperPropMaps,null,e.getSource())};i.prototype._onKeyDateChange=function(){var e=this._oDialogFormModel.getProperty("/KEY_DATE");if(!e)this._resetKeyDate()};i.prototype._onKeyDateParseError=function(){this._resetKeyDate()};i.prototype._onOK=function(){this._fetchReportURL()};i.prototype._onCancel=function(){this._close()};return i});