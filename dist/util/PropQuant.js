sap.ui.define(["sap/ui/model/json/JSONModel","sap/base/assert","gramont/VCDSM/specedit/control/Column","gramont/VCDSM/specedit/control/ColumnListItem","gramont/VCDSM/specedit/util/TableManager","gramont/VCDSM/specedit/util/PropBase","gramont/VCDSM/specedit/util/ModelManagerAdmin","gramont/VCDSM/specedit/util/ModelManagerAutoGrowOp","gramont/VCDSM/specedit/util/ModelManagerIntStatus","sap/ui/richtexteditor/RichTextEditor"],function(e,t,a,o,r,n,l,s,i,d){"use strict";var u=function(a,o,r,s,d,u,p,g,c){n.call(this,a,"gramont.VCDSM.specedit.frag.PropQuant");this._subsec=this._byId("quantsubsec");p[c].propid=this._subsec;this._subsec.setVisible(g.Visible);this._bEditable=s;this._estcat=o.ESTCAT;var m=new e;var v=this.getControl();v.setModel(m,"propModel");m.setProperty("/title",o.TEXT);var h=r.getAdditional().parent.CompHeaderqnt;var C=r.getAdditional();var M=this._byId("quant");for(var b=0;b<h.length;b++){var f=h[b];var w=f.ColDescr;var _=null;if(w!=a.getI18nBundle().getText("PropInstance.sortOrder")){_=new sap.m.Label({});_.setText(w);t(_,a.getI18nBundle().getText("errorhead"));var I=new sap.m.Column({header:_});M.addColumn(I)}}var y=new sap.m.ColumnListItem;var T=function(e){var a=e.getSource().getBindingContext().getPath().split("/");t(a.length==2&&a[0]=="","Control should have absolute binding context path");var o=parseInt(a[1]);var r=e.getSource().getModel();var n=r.getData().length;var s="/"+o+"/"+l.FullPropName.IntStatus;var d=r.getProperty(s);var u=null;switch(d){case i.Empty:u=i.New;break;case i.Unchanged:u=i.Modified;break}if(u!=null)r.setProperty(s,u)};for(b=0;b<h.length;b++){f=h[b];var S=f.AsRadiobutton;if(S==true&&b!=5){var D="{"+h[0].ColId+"}";y.addCell(new sap.m.RadioButton({selected:"{"+f.ColId+"}",groupName:D,select:T,editable:s}))}else{var x=f.IsEditable;if(x==true){y.addCell(new sap.m.Input({value:"{"+f.ColId+"}",change:T}))}else{y.addCell(new sap.m.Text({text:"{"+f.ColId+"}"}))}}}var E=r.getModel().getData();var O=new sap.ui.model.json.JSONModel(E);M.setModel(O);M.bindItems("/",y,null,null);var V=this._byId("udt");var N=this._byId("udt");if(d!=null){var B=new sap.m.ColumnListItem;for(var A=0;A<2;A++){if(A==0){_=new sap.m.Label({});_.setText(a.getI18nBundle().getText("Name"));I=new sap.m.Column({header:_,width:"20%"})}else if(A==1){_=new sap.m.Label({});_.setText(a.getI18nBundle().getText("val"));I=new sap.m.Column({header:_})}N.addColumn(I)}B.addCell(new sap.m.Label({text:"{TEXTNAM}"}));B.addCell(new sap.ui.richtexteditor.RichTextEditor({value:"{TEXT}",change:T,editable:s,width:"100%"}));N.bindItems("/",B,null,null);var P=d.collection.getModel().getData();var L=new sap.ui.model.json.JSONModel(P);V.setModel(L)}else{V.setVisible(false)}};u.prototype._onCharEdit=function(e,t,a){var o=e.getEntryIndexOfControl(a.getSource());var r=e.getEntry(o);t.openEdit(r,jQuery.proxy(this._onCharEditStore,this,t,o,e))};u.prototype._onCharEditStore=function(e,t,a,o,r){a.setFieldValue(t,e.getFieldName(),o,r)};u.prototype=Object.create(n.prototype);u.prototype.constructor=u;u.prototype._formatEditMode=function(e){var t=e&&this._bEditable;return t};u.prototype._infopop=function(t){this._oevent=t;var a="/sap/opu/odata/GMT/VC_ODATA_SRV";var o=new sap.ui.model.odata.ODataModel(a,true);var r=this;var n={method:"GET",urlParameters:{ESTCAT:r._estcat},context:null,success:function(t,a){r._oDialogadd=r._oComponent.getNavigator().createFragment("gramont.vc.specedit.frag.helpopup",r);r._Odiahelp=new e;r._Odiahelp.setProperty("/aData",t.Info);r._oDialogadd.control.setModel(r._Odiahelp,"resModel");r._oDialogadd.control.openBy(r._oevent.getSource());r.getOwnerComponent().getNavigator().releaseBusyDialog()},error:function(e){sap.m.MessageToast.show(e.message);r.getOwnerComponent().getNavigator().releaseBusyDialog()},async:true};o.callFunction("/GetVatInfo",n);this.getOwnerComponent().getNavigator().requireBusyDialog()};return u});